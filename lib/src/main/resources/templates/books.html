<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi">
<head th:replace="~{layout/header :: head(pageTitle=${pageTitle != null ? pageTitle : 'Danh sách sách'})}"></head>
<body style="background-color: #1e1e1e;">
<header th:replace="~{layout/header :: header}"></header>

<div class="d-flex justify-content-between align-items-center mb-4">
    </div>

<div class="book-grid-container">
    <div th:if="${bookPage.isEmpty()}">
        <div class="alert alert-warning">Không tìm thấy cuốn sách nào.</div>
    </div>
    
    <div th:unless="${bookPage.isEmpty()}" class="row g-4">
        <div class="col-lg-6" th:each="book : ${bookPage.content}">
            <article class="book-grid-item">
                <a th:href="@{'/books/detail/' + ${book.id}}">
                     <img th:src="${book.image != null and not #strings.isEmpty(book.image) ? '/uploads/' + book.image : 'https://via.placeholder.com/90x120.png?text=Cover'}"
                         class="book-grid-item__cover" alt="Book Cover">
                </a>
                <div class="book-grid-item__info">
                    <div>
                        <a th:href="@{'/books/detail/' + ${book.id}}" class="book-grid-item__title" th:text="${book.title}">Tên sách</a>
                        <p class="book-grid-item__description" th:text="${book.description}">Mô tả ngắn...</p>
                    </div>
                    <div class="book-grid-item__actions">
                        <div class="book-grid-item__meta">
                            <span th:if="${book.author}"><i class="bi bi-person"></i> <span th:text="${book.author.name}"></span></span>
                            <br>
                            <span th:if="${book.category}"><i class="bi bi-tag"></i> <span th:text="${book.category.name}"></span></span>
                        </div>
                        <div>
                             <a th:href="@{'/books/detail/' + ${book.id}}" class="btn btn-read">Đọc thử</a>
                            <div class="text-muted text-end mt-1" style="font-size: 0.8rem;">
                                <span th:if="${book.pageCount}" th:text="${book.pageCount} + ' trang'"></span>
                            </div>
                        </div>
                    </div>
                </div>
            </article>
        </div>
    </div>
</div>

<nav aria-label="Page navigation" class="mt-5" th:if="${bookPage.totalPages > 1}">
    <ul class="pagination justify-content-center">
        <li class="page-item" th:classappend="${bookPage.isFirst()} ? 'disabled' : ''">
            <a class="page-link" th:href="@{/books(page=${bookPage.number}, size=${bookPage.size})}">Trước</a>
        </li>
        
        <li class="page-item" th:each="pageNumber : ${pageNumbers}" 
            th:classappend="${pageNumber == bookPage.number + 1} ? 'active' : ''">
            <a class="page-link" th:href="@{/books(page=${pageNumber}, size=${bookPage.size})}" th:text="${pageNumber}"></a>
        </li>
        
        <li class="page-item" th:classappend="${bookPage.isLast()} ? 'disabled' : ''">
            <a class="page-link" th:href="@{/books(page=${bookPage.number + 2}, size=${bookPage.size})}">Sau</a>
        </li>
    </ul>
</nav>

<div th:replace="~{layout/footer :: footer}"></div>
</body>
</html>